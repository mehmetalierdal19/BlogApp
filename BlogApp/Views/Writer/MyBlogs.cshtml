@using EntityLayer.Concrete
@model List<Blog>

@{
    ViewData["Title"] = "MyBlogs";
    Layout = "~/Views/Shared/WriterLayout.cshtml";
}

<div class="col-lg-12 grid-margin stretch-card">
    <div class="card">
        <div class="card-body">
            <h4 class="card-title">My Blogs</h4>
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Title</th>
                        <th>Create Date</th>
                        <th>Category</th>
                        <th>Status</th>
                        <th>Delete</th>
                        <th>Update</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <th>@item.BlogID</th>
                            <td>@item.Title</td>
                            <td>@item.CreateDate.Day.@item.CreateDate.Month.@item.CreateDate.Year</td>
                            <td>@item.Category.Name</td>
                            <td>
                                @if (item.Status)
                                {
                                    <span class="badge badge-success">Active</span>
                                }
                                else
                                {
                                    <span class="badge badge-danger">Passive</span>
                                }
                            </td>
                            <td>
                                <a href="#" class="btn btn-danger btn-sm delete-button" data-id="@item.BlogID">
                                    <i class="mdi mdi-delete-variant"></i> Delete
                                </a>
                            </td>
                            <td>
                                <a href="/Writer/EditBlog/@item.BlogID" class="btn btn-warning btn-sm">
                                    <i class="mdi mdi-autorenew"></i> Update
                                </a>
                            </td>
                        </tr>
                    }
            </table>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const deleteButtons = document.querySelectorAll('.delete-button');

        deleteButtons.forEach(button => {
            button.addEventListener('click', function (e) {
                e.preventDefault();

                const blogId = this.getAttribute('data-id');

                Swal.fire({
                    title: 'Are you sure?',
                    text: "You are about to delete this blog post!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    cancelButtonColor: '#3085d6',
                    confirmButtonText: 'Yes, delete it!',
                    cancelButtonText: 'Cancel'
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = `/Writer/DeleteBlog/${blogId}`;
                    }
                });
            });
        });
    });
</script>
